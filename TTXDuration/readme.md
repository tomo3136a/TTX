# TTXDuration

## 概要

TTXDuration は、Tera Term の拡張プラグインです。

接続経過時間を表示します。

## インストール

Tera Term のプログラムフォルダに TTXDuration.dll を複製します。

## 設定ファイル

設定ファイルに [TTXDuration] セクションを作成し、機能を設定をします。

```ini
[TTXDuration]
EnableOnOff=on
ResetStart=on
ConnectStart=on
DisconnectStop=on
Border1=60
Border2=40
Border3=20
```

### EnableOnOff

接続経過時間ボタンを表示します。

"on" または "off" を指定します。
省略時は "off" となります。

### ResetStart

タイマ開始時に経過時間タイマを0クリアします。

"on" または "off" を指定します。
省略時は "off" となります。

### ConnectStart

接続時に経過時間タイマを開始します。

"on" または "off" を指定します。
省略時は "off" となります。

### DisconnectStop

切断時に経過時間タイマを停止します。

"on" または "off" を指定します。
省略時は "off" となります。

### Border1

指定時間(秒)経過後に経過時間表示を赤色表示します。

省略または "0" を指定した場合は機能を無効にします。

### Border2

指定時間(秒)経過後に経過時間表示を黄色表示します。

省略または "0" を指定した場合は機能を無効にします。

Border1 より小さい値である必要があります。

### Border3

指定時間(秒)経過後に経過時間表示を緑色表示します。

省略または "0" を指定した場合は機能を無効にします。

Border2 より小さい値である必要があります。

## 使い方

メニュー[タイマ]をクリックすることにより経過時間タイマを開始/終了させることができます。

メニュー[コントロール]-[経過時間]-[タイマ接続開始]

接続時に経過時間タイマを開始する設定にします。
「タイマ接続開始」機能を有効・無効の選択をすることが出来ます。機能が有効の場合は、メニュー項目にチェックが付きます。

メニュー[コントロール]-[経過時間]-[タイマ切断停止]

接続切断時に経過時間タイマを停止する設定にします。
「タイマ切断停止」機能を有効・無効の選択をすることが出来ます。機能が有効の場合は、メニュー項目にチェックが付きます。

メニュー[コントロール]-[経過時間]-[タイマリセット開始]

経過時間タイマを開始するときは 0 クリアする設定にします。
「タイマリセット開始」機能を有効・無効の選択をすることが出来ます。機能が有効の場合は、メニュー項目にチェックが付きます。

メニュー[コントロール]-[経過時間]-[開始/停止メニュー]

経過時間タイマボタンを表示します。
「開始/停止メニュー」機能を有効・無効の選択をすることが出来ます。機能が有効の場合は、メニュー項目にチェックが付きます。

メニュー[コントロール]-[経過時間]-[タイマクリア]

経過時間タイマを 0 クリアします。

## マクロからのメニュー呼び出し

「タイマ」の開始・停止切り替え

経過時間タイマの開始、停止を切り替えます。

``` ttl
callmenu 56070
```

「タイマ接続開始」の切り替え

接続時に経過時間タイマの開始をするかしないかを切り替えます。

``` ttl
callmenu 56071
```

「タイマ切断停止」の切り替え

切断時に経過時間タイマを停止するかしないかを切り替えます。

``` ttl
callmenu 56072
```

「タイマリセット開始」の切り替え

経過時間タイマの開始時に経過時間を 0 にするかしないかを切り替えます。

``` ttl
callmenu 56073
```

「タイマ」メニューの切り替え

タイマメニューボタンを切り替えます。

``` ttl
callmenu 56075
```

初期化

経過時間タイマ停止・経過時間タイマ接続開始無効・経過時間タイマ切断停止無効・経過時間タイマ開始時 0 クリア無効

``` ttl
callmenu 56076
```
