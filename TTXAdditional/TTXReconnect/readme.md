# COM ポート遅延再接続プラグイン for Tera Term

## 概要

主な用途は、外部装置と USB 経由での UART 通信用です。

一般的な USB-UART 変換ケーブルでは発生しないのですが、装置に組み込まれた USB I/F に USB ケーブルでつないで UART 通信する場合、 Tera Term の自動再接続機能(AutoComPortReconnect) が失敗のダイアログを表示することがあります。

USBケーブル接続後、少し待ってから COM ポートを開くと問題なく通信できます。

このため、自動再接続機能が USB 接続を検知してから COM ポートを開くまでの間に、一定時間のガード時間を設けることで回避するプラグインです。

また、能動的に UART 接続を再接続したい場合、メニュー「ファイル-接続断」してメニュー「ファイル-新しい接続」・「接続先選択」をすると手間がかかるため、メニューに「再接続」を設けました。

## 対応バージョン

以下のバージョンで動作を確認

  Tera Term v4.96, v4.98, v4.104

以下のバージョンでは正常に動作しません

  Tera Term v4.105

## 使い方

1. プラグインをビルドします。
2. Tera Term 実行環境 (ttermpro.exeがあるフォルダ) にビルドした TTXReconnect.dll をコピーします。
3. TERATERM.INI 設定ファイルを追加修正します。
4. Tera Term を実行し、 COM ポートで UART 通信します。
5. 再接続を行うときは、メニュー[ファイル-再接続] を選択します。

## 設定ファイル

再接続待ち時間をミリ秒で指定します。省略時 0 と同等です。

例：再接続待ち時間 1 秒の場合

```ini
[TTXReconnect]
ReconnectWait=1000
```

## 開発メモ

### バージョン間の位置ずれを補正するTTSet構造体補正マクロ版をビルド

コンパイルオプションで /D"_TTX_VERSION_SUPPORT" を指定します。

## ビルド

cmake でビルドする場合

```bat
mkdir build
cd build
cmake -A Win32 ..
cmake --build . --config Release
```
